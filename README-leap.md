# Инструкция для воспроизведения Sendly NFT Gift Card dApp в Leap

## Описание проекта

Создайте децентрализованное приложение для создания и управления NFT подарочными картами на сети Base. Приложение позволяет пользователям создавать, отправлять, получать и тратить цифровые подарочные карты в виде NFT с поддержкой USDC и USDT токенов.

## Основная функциональность

### Ключевые возможности:
- **Создание подарочных карт**: Пользователи могут создавать NFT подарочные карты с указанием получателя, суммы, валюты (USDC/USDT) и персонального сообщения
- **Управление картами**: Просмотр отправленных и полученных подарочных карт с фильтрацией и поиском
- **Трата карт**: Возможность активировать полученные подарочные карты и получить токены на свой кошелек
- **История транзакций**: Полная история всех операций с аналитикой и экспортом данных
- **Генерация изображений**: Автоматическое создание визуальных представлений подарочных карт
- **IPFS интеграция**: Хранение метаданных и изображений в децентрализованной сети

### Технические требования:
- **Frontend**: React 18, TypeScript, Vite
- **UI**: Tailwind CSS, Radix UI компоненты, Lucide React иконки
- **Web3**: Wagmi, Viem, RainbowKit для подключения кошельков
- **Blockchain**: Base Network (Ethereum L2)
- **Хранение**: IPFS через Pinata для метаданных NFT
- **Смарт-контракты**: Solidity контракты для управления подарочными картами

## Структура приложения

### Главные компоненты:
1. **App.tsx** - Основной компонент с навигацией и управлением состоянием
2. **CreateGiftCard.tsx** - Форма создания подарочных карт с предварительным просмотром
3. **MyCards.tsx** - Управление отправленными и полученными картами
4. **SpendCard.tsx** - Интерфейс для активации подарочных карт
5. **TransactionHistory.tsx** - История транзакций с аналитикой

### Утилиты:
- **web3Service.ts** - Сервис для взаимодействия с блокчейном
- **pinataService.ts** - Загрузка файлов в IPFS
- **imageGenerator.ts** - Генерация изображений подарочных карт
- **constants.ts** - Конфигурация контрактов и адресов

## Детальная реализация

### 1. Создание подарочных карт
Создайте форму с полями:
- Адрес получателя (обязательно)
- Сумма в долларах (обязательно)
- Валюта: USDC или USDT
- Дизайн карты: розовый, синий, зеленый
- Персональное сообщение
- Дополнительные опции: таймер, пароль, срок действия

Процесс создания:
1. Генерация изображения карты с помощью Canvas API
2. Загрузка изображения в IPFS через Pinata
3. Создание метаданных NFT
4. Загрузка метаданных в IPFS
5. Вызов смарт-контракта для создания NFT
6. Отображение результата с хешем транзакции

### 2. Управление картами
Реализуйте два раздела:
- **Отправленные карты**: Карты, созданные текущим пользователем
- **Полученные карты**: Карты, принадлежащие текущему пользователю

Функции:
- Поиск по сообщению или адресу
- Фильтрация по статусу (активные, потраченные, истекшие)
- Фильтрация по валюте
- Копирование ссылки на карту
- Поделиться картой

### 3. Активация карт
Интерфейс для траты подарочных карт:
- Выбор карты в интерфейсе
- Проверка владения картой
- Проверка статуса (не потрачена, не истекла)
- Подтверждение активации
- Получение токенов на кошелек

### 4. История транзакций
Аналитическая панель с:
- Общей статистикой (отправлено, получено, потрачено)
- Списком всех транзакций
- Фильтрацией по типу, валюте, дате
- Экспортом в CSV
- Ссылками на блокчейн-эксплореры

## Смарт-контракт

### Основные функции контракта:
```solidity
contract GiftCard is ERC721Enumerable, ERC721URIStorage, Ownable {
    // Создание подарочной карты
    function createGiftCard(
        address _recipient,
        uint256 _amount,
        address _token,
        string memory _metadataURI,
        string memory _message
    ) public returns (uint256)
    
    // Активация подарочной карты
    function redeemGiftCard(uint256 tokenId) public
    
    // Получение информации о карте
    function getGiftCardInfo(uint256 tokenId) public view returns (GiftCardInfo memory)
}
```

### Структура данных:
```solidity
struct GiftCardInfo {
    uint256 amount;      // Сумма в токенах
    address token;       // Адрес токена (USDC/USDT)
    bool redeemed;       // Статус активации
    string message;      // Сообщение от отправителя
}
```

## Web3 интеграция

### Конфигурация:
- **Сеть**: оставь пустым
- **RPC**: оставь пустым
- **Контракты**: USDC (оставь пустым), USDT (оставь пустым)

### Основные операции:
1. **Подключение кошелька** через RainbowKit
2. **Проверка баланса** USDC/USDT токенов
3. **Approve токенов** для контракта
4. **Создание NFT** через смарт-контракт
5. **Активация карты** и получение токенов
6. **Чтение событий** для истории транзакций

## IPFS интеграция

### Pinata сервис:
- Загрузка изображений подарочных карт
- Создание метаданных NFT в формате OpenSea
- Возврат IPFS URI для хранения в блокчейне

### Структура метаданных:
```json
{
  "name": "Gift Card - $50 USDC",
  "description": "A digital gift card worth $50 USDC. Happy Birthday!",
  "image": "ipfs://QmHash...",
  "attributes": [
    {"trait_type": "Amount", "value": "50"},
    {"trait_type": "Currency", "value": "USDC"},
    {"trait_type": "Design", "value": "pink"},
    {"trait_type": "Message", "value": "Happy Birthday!"}
  ]
}
```

## UI/UX требования

### Дизайн:
- Градиентный фон (фиолетовый к синему)
- Современные карточки с тенями
- Адаптивный дизайн для мобильных устройств
- Анимации загрузки и переходов

### Компоненты:
- Табы для навигации между разделами
- Модальные окна для подтверждений
- Toast уведомления для обратной связи
- Скелетоны для состояний загрузки

### Цветовая схема:
- Основной: Градиент от фиолетового к синему
- Карты: Розовый, синий, зеленый градиенты
- Статусы: Зеленый (активно), синий (потрачено), красный (истекло)

## Обработка ошибок

### Типы ошибок:
- Ошибки подключения к RPC
- Недостаточный баланс токенов
- Ошибки загрузки в IPFS
- Ошибки смарт-контракта
- Проблемы с кошельком

### Стратегии:
- Retry логика для RPC запросов
- Fallback RPC endpoints
- Кэширование данных
- Graceful degradation
- Информативные сообщения об ошибках

## Производительность

### Оптимизации:
- Кэширование данных блокчейна (5 минут)
- Пакетная загрузка NFT
- Ленивая загрузка изображений
- Debounce для поиска
- Мемоизация компонентов

### Ограничения:
- Максимум 8 одновременных RPC запросов
- Таймаут 8 секунд для RPC
- Ограничение истории последними 5000 блоками

## Развертывание

### Переменные окружения:
```env
VITE_CONTRACT_ADDRESS=0x7f5c9e8548002134cde6093f2ca3ff5b8bd26982
VITE_USDC_ADDRESS=0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913
VITE_USDT_ADDRESS=0xfde4c96c8593536e31f229ea8f37b2ada2699bb2
VITE_PINATA_API_KEY=your_pinata_api_key
VITE_PINATA_SECRET_API_KEY=your_pinata_secret_key
VITE_WALLET_CONNECT_PROJECT_ID=your_walletconnect_project_id
```

### Сборка:
```bash
npm install
npm run build
npm run preview
```

Это приложение представляет собой полнофункциональную DeFi платформу для подарочных карт с современным UI, надежной блокчейн интеграцией и отличным пользовательским опытом.



